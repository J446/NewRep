close all
clear all
VuralFit=[-4.8 545
    -3.7259	545.1634
-3.7008	544.0663
-3.676	544.0637
-3.6511	544.0611
-3.6261	544.0586
-3.6012	544.056
-3.5763	544.0535
-3.5514	544.0509
-3.5265	544.0484
-3.5016	544.0458
-3.4766	544.0432
-3.4517	544.0407
-3.4268	544.0381
-3.4019	544.0356
-3.3769	544.033
-3.3519	544.0305
-3.3271	544.0279
-3.3022	544.0253
-3.2772	544.0228
-3.2523	544.0202
-3.2274	544.0177
-3.2025	544.0151
-3.1776	544.0126
-3.1526	544.01
-3.1277	544.0074
-3.1028	544.0049
-3.0779	544.0023
-3.053	543.9998
-3.028	543.9971
-3.0031	543.9947
-2.9782	543.9921
-2.9533	543.9895
-2.9283	543.987
-2.9034	543.9844
-2.8784	543.9819
-2.8536	543.9792
-2.8287	543.9767
-2.8037	543.9742
-2.7788	543.9716
-2.7539	543.9691
-2.729	543.9665
-2.704	543.964
-2.6791	543.9614
-2.6542	543.9588
-2.6293	543.9563
-2.6044	543.9537
-2.5794	543.9512
-2.5545	543.9485
-2.5295	543.9461
-2.5047	543.9435
-2.4798	543.9409
-2.4548	543.9384
-2.4299	543.9358
-2.405	543.9333
-2.3801	543.9306
-2.3551	543.9282
-2.3302	543.9256
-2.3053	543.923
-2.2804	543.9205
-2.2555	543.9179
-2.2305	543.9154
-2.2056	543.9127
-2.1807	543.9102
-2.1558	543.9077
-2.1308	543.9051
-2.1059	543.9026
-2.081	543.9
-2.0561	543.8975
-2.0312	543.8949
-2.0062	543.8923
-1.9813	543.8898
-1.9564	543.8872
-1.9315	543.8847
-1.9064	543.882
-1.8816	543.8796
-1.8567	543.877
-1.8317	543.8744
-1.8069	543.8719
-1.7819	543.8693
-1.757	543.8668
-1.7321	543.8641
-1.7072	543.8617
-1.6822	543.8591
-1.6573	543.8565
-1.6324	543.854
-1.6075	543.8514
-1.5826	543.8489
-1.5575	543.8463
-1.5327	543.8437
-1.5078	543.8412
-1.4828	543.8386
-1.4579	543.8361
-1.433	543.8335
-1.4081	543.831
-1.3832	543.8284
-1.3583	543.8258
-1.3333	543.8233
-1.3084	543.8207
-1.2835	543.8182
-1.2586	544.9102
-1.2336	544.9077
-1.2086	544.9051
-1.1838	544.9026
-1.1589	544.9
-1.134	544.8974
-1.109	544.8949
-1.0841	544.8923
-1.0592	544.8898
-1.0343	544.8872
-1.0093	544.8847
-0.9844	544.882
-0.9595	544.8795
-0.9346	544.877
-0.9097	544.8744
-0.8847	544.8719
-0.8598	544.8693
-0.8349	544.8668
-0.81	544.8641
-0.785	544.8616
-0.7601	544.8591
-0.7351	544.8565
-0.7103	544.854
-0.6854	544.8514
-0.6604	544.8489
-0.6355	544.8463
-0.6106	544.8437
-0.5857	544.8412
-0.5607	544.8386
-0.5358	544.8361
-0.5109	544.8335
-0.486	544.8309
-0.4611	544.8284
-0.4361	544.8258
-0.4112	544.8233
-0.3862	544.8207
-0.3614	544.8182
-0.3364	544.8155
-0.3115	544.813
-0.2866	544.8105
-0.2617	544.8079
-0.2368	544.8054
-0.2118	544.8028
-0.1869	544.8003
-0.162	544.7976
-0.1371	544.7951
-0.1121	544.7926
-0.0872	544.79
-0.0623	544.7875
-0.0374	544.7849
-0.0125	544.7824
0.0125	544.7798
0.0374	544.7772
0.0623	544.7747
0.0872	544.7721
0.1121	544.7696
0.1371	544.767
0.162	544.7645
0.1869	544.7619
0.2118	544.7593
0.2368	544.7568
0.2617	544.7542
0.2866	544.7517
0.3115	544.749
0.3364	544.7466
0.3614	544.744
0.3862	544.7414
0.4112	544.7389
0.4361	544.7363
0.4611	544.7338
0.486	544.7311
0.5109	544.7287
0.5358	544.7261
0.5607	544.7235
0.5857	544.721
0.6106	544.7184
0.6355	544.7159
0.6604	544.7133
0.6854	544.7107
0.7103	544.7082
0.7351	544.7056
0.7601	544.7031
0.785	544.7005
0.81	544.698
0.8349	544.6954
0.8598	544.6928
0.8847	544.6903
0.9097	544.6877
0.9346	544.6852
0.9595	544.6825
0.9844	544.6801
1.0093	544.6775
1.0343	544.6749
1.0592	544.6724
1.0841	544.6698
1.109	544.6673
1.134	544.6646
1.1589	544.6622
1.1838	544.6596
1.2086	544.657
1.2336	545.749
1.2586	545.7465
1.2835	545.744
1.3084	545.7414
1.3333	545.7389
1.3583	545.7363
1.3832	545.7337
1.4081	545.7311
1.433	545.7286
1.4579	545.7261
1.4828	545.7235
1.5078	545.721
1.5327	545.7184
1.5575	545.7158
1.5826	545.7133
1.6075	545.7107
1.6324	545.7082
1.6573	545.7056
1.6822	545.7031
1.7072	545.7005
1.7321	545.6979
1.757	545.6954
1.7819	545.6928
1.8069	545.6903
1.8317	545.6877
1.8567	545.6852
1.8816	545.6825
1.9064	545.68
1.9315	545.6775
1.9564	545.6749
1.9813	545.6724
2.0062	545.6698
2.0312	545.6672
2.0561	545.6646
2.081	546.7567
2.1059	546.7542
2.1308	546.7516
2.1558	546.749
2.1807	546.7465
2.2056	546.744
2.2305	546.7414
2.2555	546.7388
2.2804	547.8309
2.3053	547.8283
2.3302	547.8258
2.3551	547.8232
2.3801	547.8207
2.405	547.8181
2.4299	548.9101
2.4548	548.9076
2.4798	548.905
2.5047	548.9024
2.5295	549.9945
2.5545	549.992
2.5794	549.9893
2.6044	551.0815
2.6293	551.0789
2.6542	551.0763
2.6791	552.1684
2.704	552.1658
2.729	552.1633
2.7539	553.2553
2.7788	553.2528
2.8037	554.3448
2.8287	554.3423
2.8536	555.4343
2.8784	555.4317
2.9034	556.5238
2.9283	556.5211
2.9533	557.6133
2.9782	557.6107
3.0031	558.7027
3.028	558.7002
3.053	559.7923
3.0779	560.8843
3.1028	560.8817
3.1277	561.9738
3.1526	563.0658
3.1776	564.1579
3.2025	564.1553
3.2274	565.2474
3.2523	566.3394
3.2772	567.4315
3.3022	568.5234
3.3271	569.6156
3.3519	570.7076
3.3769	571.7997
3.4019	572.8917
3.4268	573.9838
3.4517	575.0758
3.4766	576.1679
3.4766	577.2625
3.5016	577.2599
3.5016	578.3545
3.5265	578.3519
3.5265	579.4466
3.5265	580.5412
3.5514	581.6332
3.5763	582.7252
3.6012	583.8173
3.6261	584.9094
3.6511	586.0014
3.6511	587.096
3.676	588.1881
3.7008	589.2801
3.7259	590.3721
3.7508	591.4642
3.7508	592.5588
3.7757	593.6509
3.8006	594.7429
3.8255	595.8349
3.8255	596.9296
3.8505	598.0216
3.8754	599.1136
3.9003	600.2057
3.9003	601.3003
3.9252	602.3923
3.9502	603.4844
3.9502	604.579
3.975	605.671
4	606.7631
4.0249	607.8551
4.0249	608.9497
4.0498	610.0418
4.0748	611.1338
4.0748	612.2284
4.0997	613.3205
4.1246	614.4125
4.1246	615.5072
4.1495	616.5992
4.1745	617.6912
4.1745	618.7859
4.1994	619.8779
4.2243	620.9699
4.2243	622.0646
4.2492	623.1566
4.2741	624.2486
4.2741	625.3433
4.2991	626.4353
4.324	627.5272
4.324	628.6219
4.3489	629.714
4.3489	630.8086
4.3738	631.9007
4.3988	632.9927
4.3988	634.0873
4.4237	635.1794
4.4237	636.274
4.4485	637.366
4.4485	638.4606
4.4735	639.5527
4.4984	640.6447
4.4984	641.7393
4.5234	642.8314
4.5483	642.8288
4.5732	643.9207
4.5981	643.9183];
Vural=[-4	545
-3	539
-2.3	537
-2	543
-1.028	548
-0.31	542
0.654	555
0.97	551
2.27	540
2.68	555
2.78	558
2.95	549
2.97	571
2.8	576
3.04	581
3.19	554
3.28	563
3.28	578
0.358	569
3.69	592
4	610
4.1	599
3.8	614];
BaseMetal=[519	2.00E-04
    521	2.00E-04
576	526
565	578
582	580
583	589
628	1228
535	1598
595	1613
600	1656
620	3407
680	3408
559	3486
610	3513];
HAZOuter=[429	2.00E-04
    424	2.00E-04
476	600
512	624
500	625
462	645
514	1700
512	1714
505	1782
508	1817
547	3574
536	3608
520	3647
570	3742];
HAZInner=[380	2.00E-04
    360	2.00E-04
384	653
358	667
370	673
416	1186
396	1752
448	1787
387	1797
410	1833
447	3438
475	3553
462	3595
438	3758];
Nugget=[301	2.00E-04
    310	2.00E-04
417	645
416	678
394	757
416	759
420	1679
442	1716
453	1783
434	1838
456	3390
417	3400
467	3456
445	3594];

BaseMetal=[519	2.00E-04
    521	2.00E-04
576	526
565	578
582	580
583	589
628	1228
535	1598
595	1613
600	1656
620	3407
680	3408
559	3486
610	3513];
HAZOuter=[429	2.00E-04
    424	2.00E-04
476	600
512	624
500	625
462	645
514	1700
512	1714
505	1782
508	1817
547	3574
536	3608
520	3647
570	3742];
HAZInner=[380	2.00E-04
    360	2.00E-04
430	653
425	667
435	673
480	1186
485	1752
475	1787
490	1797
500	1833
495	3438
505	3553
490	3595
480	3758];
Nugget=[301	2.00E-04
    310	2.00E-04
417	645
416	678
394	757
416	759
420	1679
442	1716
453	1783
434	1838
456	3390
417	3400
467	3456
445	3594];

%Checked for 5% flow stress
% BaseMetal2=[520	2.00E-04
%     520	2.00E-04
% 586	526
% 575	578
% 573	580
% 585	589
% 535	1228
% 614	1598
% 610	1613
% 616	1656
% 605	3407
% 535	3408
% 552	3486
% 656	3513];
% HAZOuter2=[430	2.00E-04
%     425	2.00E-04
% 460	600
% 503	624
% 504	625
% 466	645
% 490	1700
% 440	1714
% 520	1782
% 538	1817
% 423	3574
% 412	3608
% 520	3647
% 460	3742];
% HAZInner2=[395	2.00E-04
%     385	2.00E-04
% 418	653
% 358	667
% 365	673
% 380	700
% 410	1752
% 425	1787
% 416	1797
% 408	1833
% 400	3438
% 412	3595
% 462	3758];
% Nugget2=[300	2.00E-04
%     280	2.00E-04
%     
%     416	645
% 384	678
% 414	757
% 430	759
% 420	1679
% 450	1716
% 470	1783
% 455	1838
% 370	3390
% 430	3400
% 423	3456
% 430	3594];

% JefFit=[-4.1 520
% 2.7 570
% 4.5 700];
% JefFit2=[-4.1 490
% 2.7 550
% 4.5 670];
% JefFit3=[-4.1 540
% 2.7 540
% 4.5 670];
% JefFit4=[-4.1 450
% 2.7 550
% 4.5 660];
JefFit=[-4.1 520
2.7 570
4.5 700];
JefFit2=[-4.1 520
2.7 570
4.5 700];
JefFit3=[-4.1 500
2.7 570
4.5 700];
JefFit4=[-4.1 480
2.7 570
4.5 700];

figure;
plot((Vural(:,1)),Vural(:,2),'xk');
% hold on;
% plot((VuralFit(:,1)),VuralFit(:,2),'-k');

hold on;
plot(log10(BaseMetal(:,2)),BaseMetal(:,1),'sk');
hold on;
% plot(log10(BaseMetal2(:,2)),BaseMetal2(:,1),'sr');
hold on;
plot((JefFit(:,1)),JefFit(:,2)-5,':k');
xlim([0 5]);
ylim([0 1000]);
xlabel('Log10(Strain rate (s^{-1}))');
ylabel('Flow stress at 5% offset (MPa)');

% figure;
hold on;
plot(log10(HAZOuter(:,2)),HAZOuter(:,1),'vk','MarkerFaceColor',[0 0 0]);
hold on;
% plot(log10(HAZOuter2(:,2)),HAZOuter2(:,1),'vr');
% hold on;
% plot((VuralFit(:,1)),VuralFit(:,2)-90,'-k');
hold on;
plot((JefFit2(:,1)),JefFit2(:,2)-90,':k');
xlim([0 5]);
ylim([0 1000]);
xlabel('Log10(Strain rate (s^{-1}))');
ylabel('Flow stress at 5% offset (MPa)');

% figure;
hold on;
plot(log10(HAZInner(:,2)),HAZInner(:,1),'ok');
hold on;
% plot(log10(HAZInner2(:,2)),HAZInner2(:,1),'^r');
% hold on;
% plot((VuralFit(:,1)),VuralFit(:,2)-160,'-k');
hold on;
plot((JefFit3(:,1)),JefFit3(:,2)-130,':k');
xlim([0 5]);
ylim([0 1000]);
xlabel('Log10(Strain rate (s^{-1}))');
ylabel('Flow stress at 5% offset (MPa)');

% figure;
hold on;
plot(log10(Nugget(:,2)),Nugget(:,1),'*k');
hold on;
% plot(log10(Nugget2(:,2)),Nugget2(:,1),'*r');
% hold on;
% plot((VuralFit(:,1)),VuralFit(:,2)-150,'-k');
hold on;
plot((JefFit4(:,1)),JefFit4(:,2)-180,':k');

xlim([-5 5]);
ylim([200 800]);
xlabel('Log10(Strain rate (s^{-1}))');
ylabel('Flow stress at 5% offset (MPa)');